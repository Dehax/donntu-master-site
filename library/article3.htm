<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Сквозное шифрование переписки в социальной сети «ВКонтакте» — Д.В. Кубашевский, А.В. Чернышова</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="../css/style.css">
</head>

<body>
  <div class="NavbarTopOffset"></div>

  <div class="container">
    <nav class="navbar navbar-expand-xl navbar-dark bg-primary fixed-top" id="menu">
      <a class="navbar-brand" href="/" target="_blank" title="Перейти на портал магистров ДонНТУ">Портал магистров</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Переключить меню">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mx-auto">
          <li class="nav-item">
            <a class="nav-link" href="../index.htm">Резюме</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../bio/index.htm">Биография</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../diss/index.htm">Реферат</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="../library/index.htm">Библиотека</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../links/index.htm">Ссылки</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../links/zvit.htm">Отчёт о поиске</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../ind/index.htm">Индивидуальный раздел</a>
          </li>
        </ul>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="http://donntu.org" target="_blank" title="Перейти на сайт ДонНТУ">ДонНТУ</a>
          </li>
        </ul>
      </div>
    </nav>

    <main class="card shadow my-4" id="middleblock">
      <div class="card-body">
        <div id="maintext">
          <h1 class="text-center">Сквозное шифрование переписки в социальной сети «ВКонтакте»</h1>

          <p>
            <strong>Авторы:</strong> Д.В. Кубашевский, А.В. Чернышова<br>
            <strong>Источник:</strong> I Международная научно-практическая конференция "Программная инженерия: методы и технологии разработки информационно-вычислительных систем (ПИИВС–2016)" / Сборник научных трудов I научно-практической конференции (студенческая секция). — Донецк, ДонНТУ — 2016, с. 44-47.
          </p>

          <h2>Аннотация</h2>

          <p>
            В данной работе выполнен анализ мессенджеров, использующих сквозное шифрование переписки, и представлен
            новый механизм сквозного шифрования на базе системы мгновенного обмена сообщениями в социальной сети
            «ВКонтакте».
          </p>

          <h2>Введение</h2>

          <p>
            Общение является основной частью нашей жизни. С появлением систем мгновенного обмена сообщениями
            (англ. Instant messaging, IM) коммуникация между людьми приобрела новый характер <a href="#ref1">[1]</a>.
            Стало возможным «живое» общение с собеседником, который находится в противоположной точке земного шара.
          </p>

          <p>
            Современные клиенты систем мгновенного обмена сообщениями, которые называются мессенджерами, использует свой
            центральный сервер, на котором хранится вся история переписки каждого из пользователей. Таким образом, лица,
            имеющие доступ к данным сервера, могут изучить содержимое переписки. Иногда возникает необходимости в полной
            конфиденциальности беседы и в этом случае приходится использовать сквозное шифрование
            (End-to-End Encryption, E2EE) — способ передачи данных, когда доступ к сообщениям имеют исключительно
            пользователи, задействованные в общении <a href="#ref2">[2]</a>.
          </p>

          <h2>Шифрование в популярных мессенджерах</h2>

          <p>
            Facebook Messenger — официальный мессенджер от разработчиков крупнейшей в мире социальной сети Facebook.
            Существуют версии для персональных компьютеров и мобильных устройств. Приложение интегрировано с системой
            обмена сообщениями на основном сайте Facebook (Facebook Chat) и построено на базе открытого протокола
            MQTT <a href="#ref3">[3]</a>. Данный мессенджер позволяет обмениваться файлами и фотографиями. К текстовым
            сообщениям можно добавлять смайлики и стикеры. Мобильная версия мессенджера предоставляет голосовую и
            видеосвязь, а также возможность передавать геометки.
          </p>

          <p>
            С июля 2016 года Facebook на своём новостном портале сообщил о запуске тестирования сквозного (End-to-End)
            шифрования с секретными чатами. Теперь появилась возможность создавать секретный диалог, содержимое которого
            доступно исключительно для создателя диалога и его собеседника — пользователя, приглашённого в секретный чат.
            Также доступна возможность задавать таймер — после истечения заданного времени сообщения удаляются из беседы.
            Сквозное шифрование в секретных чатах основано на базе протокола Signal, разработанного некоммерческой
            организацией разработчиков открытого программного обеспечения «Open Whisper Systems» <a href="#ref4">[4]</a>.
          </p>

          <p>
            WhatsApp — бесплатный частный коммерческий кроссплатформенный мессенджер с поддержкой голосовой связи.
            Позволяет пересылать текстовые сообщения, изображения, видео и аудио. Также существуют версии для
            персональных компьютеров под управлением ОС Windows и мобильных устройств под управлением ОС Android, iOS,
            Windows Phone, BlackBerry, Nokia Symbian. WhatsApp использует модифицированный протокол Extensible Messaging
            and Presence Protocol (XMPP, ранее известный как Jabber).
          </p>

          <p>
            С апреля 2016 года с выходом обновления версии 2.16.12 в WhatsApp появилось сквозное шифрование (End-to-End)
            на базе протокола Signal. Шифрование распространяется на все типы сообщений: текст, фото, видео и голосовые
            сообщения. Шифрование также доступно в групповых чатах. В реализации используются алгоритмы ECDH на
            Curve25519, AES-256, AES-GCM, HMAC-SHA256, HDKF <a href="#ref5">[5]</a>.
          </p>

          <p>
            Viber — один из популярнейших мессенджеров, поддерживающих голосовую и видеосвязь. Работает на платформах
            Android, BlackBerry, iOS, Symbian, Windows Phone, Bada и компьютерах под управлением Windows, OS X и Ubuntu.
            Позволяет отправлять текстовые сообщения со стикерами, а также нарисованные прямо в приложении картинки.
            Также в мессенджере есть групповые и публичные тематические чаты <a href="#ref6">[6]</a>.
          </p>

          <p>
            Начиная с версии 6.0, разработчики Viber внедрили в свой сервис сквозное шифрование. Таким образом, все
            сообщения, фотографии, видео, телефонные и видеовызовы будут зашифрованы с момента отправки с одного
            устройства до момента их получения адресатом. Как заявляют разработчики, ключ, необходимый для расшифровки
            данных, доступен только на устройстве, используемом для отправки сообщения, и на устройстве, используемом
            для приёма сообщения. Таким образом, никто другой не может расшифровать передаваемые данные. Групповые чаты
            также шифруются при условии, что все участники чата имеют версию мессенджера 6.0 или старше <a href="#ref7">[7]</a>.
          </p>

          <p>
            Telegram — бесплатный кроссплатформенный мессенджер, позволяющий обмениваться текстовыми сообщениями со
            смайликами и стикерами, голосовыми сообщениями, а также различным медиаконтентом. Поддерживает групповые
            чаты и публичные каналы. Сервис ориентирован на приватность — мессенджер гарантирует, что данные надёжно
            зашифрованы. В настройках безопасности доступна возможность «самоликвидации» аккаунта в случае длительного
            отсутствия пользователя в сети.
          </p>

          <p>
            Для мессенджера был создан протокол MTProto, предполагающий использование нескольких протоколов шифрования.
            При авторизации и аутентификации используются алгоритмы RSA-2048, DH-2048 для шифрования, при передаче
            сообщений протокола в сеть они шифруются AES с ключом, известным клиенту и серверу. Также применяются
            криптографические хеш-алгоритмы SHA-1 и MD5 <a href="#ref8">[8]</a>.
          </p>

          <p>
            С 8 октября 2013 года добавлена функциональность секретных чатов, в которых реализуется сквозное шифрование
            с применением алгоритма AES-256 в режиме IGE для пересылаемых сообщений <a href="#ref8">[8]</a>. В отличие
            от Viber, в Telegram секретные чаты доступны для двух пользователей. Как и в Facebook Messenger, в секретном
            чате Telegram есть возможность задания таймера. Спустя указанное время прочитанное сообщение будет удалено
            на устройстве пользователя.
          </p>

          <p>
            qTox — свободный кроссплатформенный мессенджер, реализованный на базе протокола Tox <a href="#ref9">[9]</a>.
            Позволяет осуществлять текстовую, голосовую, видеосвязь и передачу файлов. Доступен режим конференции
            (группы). Данный мессенджер отличается от ранее рассмотренных тем, что регистрация пользователей на основном
            сервере не требуется. После установки qTox автоматически создаётся пара ключей — публичный и секретный.
            Публичный ключ служит как уникальный идентификатор для поиска собеседника. Секретный ключ хранится только у
            владельца и подтверждает его подлинность, не раскрывая персональные данные. Поиск собеседников происходит
            через DHT <a href="#ref10">[10]</a>. Изначально вся переписка в qTox защищена с использованием сквозного
            шифрования.
          </p>

          <p>
            Kate Mobile — неофициальный мобильный клиент социальной сети «ВКонтакте» <a href="#ref11">[11]</a>.
            Предоставляет все возможности веб-версии ВКонтакте для ведения переписки — обмен текстовой информацией со
            смайликами и стикерами, голосовыми сообщениями и другим медиаконтентом, включая файлы допустимых форматов.
            Kate Mobile является тонким клиентом, использующим открытое API, которое предоставляется разработчиками
            ВКонтакте.
          </p>

          <p>
            В социальной сети «ВКонтакте» отсутствует шифрование переписки, поэтому она хранится на серверах сети в
            открытом виде и доступна для прочтения третьим лицам, имеющим доступ к серверам.
          </p>

          <h2>Механизм сквозного шифрования в социальной сети «ВКонтакте»</h2>

          <p>
            Реализуемый механизм сквозного шифрования переписки в социальной сети «ВКонтакте» основан на использовании
            симметричного и ассиметричного алгоритмов шифрования, алгоритма хеширования и ассиметричного алгоритма для
            создания электронной цифровой подписи (ЭЦП).
          </p>

          <p>
            В качестве симметричного алгоритма используется Rijndael — симметричный алгоритм блочного шифрования <a href="#ref12">[12]</a>.
            С помощью Rijndael будет шифроваться информация перед отправкой собеседнику (на сервер ВКонтакте). Ключ
            шифрования генерируется случайным образом и будет действителен до тех пор, пока пользователем не будет
            запрошен новый ключ.
          </p>

          <p>
            Для предотвращения компрометации ключа симметричного шифрования используется криптографический алгоритм
            ассиметричного шифрования RSA <a href="#ref13">[13]</a>. Данный алгоритм позволит безопасно передать ключ
            симметричного шифрования собеседнику по открытому каналу таким образом, что никто другой не сможет получить
            ключ и расшифровать передаваемые сообщения.
          </p>

          <p>
            Для подтверждения личности автора передаваемых сообщений и обеспечения гарантии их целостности в данном
            механизме сквозного шифрования используется электронная цифровая подпись, которая создаётся с помощью
            ассиметричного криптографического алгоритма DSA <a href="#ref14">[14]</a> и алгоритма хеширования SHA-1 <a href="#ref15">[15]</a>.
          </p>

          <p>
            API ВКонтакте позволяет выполнять передачу текстовых сообщений, что является достаточным условием для
            передачи любых данных с помощью метода кодирования Base64 <a href="#ref16">[16]</a>. Стоит отметить, что
            зашифрованные сообщения будут видны на веб-странице ВКонтакте. С другой стороны, мессенджер, который будет
            использовать реализацию описываемого механизма сквозного шифрования, также будет получать все новые
            сообщения, отправленные через веб-страницу в незашифрованном виде (обычные сообщения пользователя). Поэтому,
            с целью фильтрации зашифрованных сообщений каждое сообщение, отправленное с использованием данного механизма,
            будет содержать служебный заголовок «=== VKMessenger ===», состоящий из 19 символов: трёх символов «равно»,
            одного пробела, последовательности символов «VKMessenger», одного пробела и трёх символов «равно». После
            данного заголовка будет следовать символ конца строки. Затем следует содержимое служебного сообщения,
            закодированное методом Base64. Первым байтом содержимого является код сообщения, который описывает тип
            служебного сообщения. Затем в зависимости от типа служебного сообщения будет следовать определённый набор
            данных. Далее будет описан протокол передачи сообщений с использованием сквозного шифрования.
          </p>

          <p>
            При первом использовании описываемого механизма собеседники должны обменяться публичными ключами, с помощью
            которых будет осуществляться шифрование ключей для шифрования сообщений. Данный этап называется этапом
            «рукопожатия». Пусть собеседник А собирается отправить сообщение собеседнику Б. Тогда собеседник А
            отправляет служебное сообщение с кодом «1» и пустым набором данных. Данное служебное сообщение означает
            запрос публичного ключа. Собеседник Б должен ответить служебным сообщением с кодом «2» и публичным ключом
            RSA размером 256 байт (2048 бит).
          </p>

          <p>
            Для отправки пользовательских сообщений используются служебные сообщения с кодом «3». Протоколом
            поддерживается передача двух типов пользовательских сообщений: текста и файла с указанием его имени. После
            кода сообщения идёт код типа пользовательского сообщения (1 байт), зашифрованный ключ симметричного
            шифрования (256 байт или 2048 бит) и зашифрованное подписанное электронной цифровой подписью содержимое
            пользовательского сообщения.
          </p>

          <p>
            Формат пользовательских сообщений перед их шифровкой зависит от типа пользовательского сообщения. В случае
            текстового типа (код «1») исходный текст пользовательского сообщения представляется последовательностью байт
            в кодировке «UTF-8» <a href="#ref17">[17]</a>. В случае файлового типа (код «2») первый байт содержит длину
            имени файла. Затем следует указанное число байт, которые представляют собой имя файла в кодировке
            «ASCII» <a href="#ref18">[18]</a>. Стоит отметить, что для отправки файлов с именем, которое содержит
            символы отличные от латинских, мессенджер должен позаботиться о транслитерации имени файла для его
            корректного отображения у получателя сообщения. Далее следуют четыре байта, которые расположены в сетевом
            порядке байт (big-endian) и определяют размер файла в байтах <a href="#ref19">[19]</a>. Затем следуют байты
            содержимого файла.
          </p>

          <p>
            Содержимое пользовательского сообщения подписывается с помощью алгоритма DSA. Подписанное пользовательское
            сообщение в начале содержит электронную цифровую подпись (40 байт) и публичный ключ (444 байт), который
            позволит получателю проверить целостность данных с помощью этой подписи. Далее подписанное пользовательское
            сообщение шифруется с помощью случайно сгенерированного ключа симметричного шифрования длиной 32 байт (256 бит).
            После получения описанного служебного сообщения с кодом «3» получатель сможет определить тип пользовательского
            сообщения, расшифровать содержимое пользовательского сообщения с помощью своего приватного ключа и проверить
            подпись, удостоверившись в целостности и корректности полученного пользовательского сообщения.
          </p>

          <p>
            Таким образом, описанного набора служебных сообщений достаточно для реализации механизма сквозного
            шифрования в переписке социальной сети «ВКонтакте».
          </p>

          <h2>Выводы</h2>

          <p>
            В ходе выполнения данной работы были рассмотрены существующие реализации механизма сквозного шифрования
            переписки на примере мессенджеров для систем мгновенного обмена сообщениями, а также предложен механизм
            сквозного шифрования (End-to-End) переписки в социальной сети «ВКонтакте», реализация которого позволит
            дополнить существующую функциональность социальной сети и обеспечить безопасность и строгую
            конфиденциальность переписки.
          </p>

          <p>
            Основным преимуществом описанного механизма является тот факт, что до сих пор не существует аналогов
            реализации механизма сквозного шифрования для переписки в социальной сети «ВКонтакте».
          </p>

          <h2>Литература</h2>

          <ol>
            <li id="ref1">Система мгновенного обмена сообщениями // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Система_мгновенного_обмена_сообщениями">https://ru.wikipedia.org/wiki/Система_мгновенного_обмена_сообщениями</a></li>
            <li id="ref2">ProtonMail: Сквозное шифрование: описание и принцип работы метода // Computer Security Software Russia. [Электронный ресурс]. – Режим доступа: <a href="http://www.comss.ru/page.php?id=2468">http://www.comss.ru/page.php?id=2468</a></li>
            <li id="ref3">Facebook Messenger // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Facebook_Messenger">https://ru.wikipedia.org/wiki/Facebook_Messenger</a></li>
            <li id="ref4">Messenger Starts Testing End-to-End Encryption with Secret Conversations // Facebook. [Электронный ресурс]. – Режим доступа: <a href="https://newsroom.fb.com/news/2016/07/messenger-starts-testing-end-to-end-encryption-with-secret-conversations/">https://newsroom.fb.com/news/2016/07/messenger-starts-testing-end-to-end-encryption-with-secret-conversations/</a></li>
            <li id="ref5">WhatsApp // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/WhatsApp">https://ru.wikipedia.org/wiki/WhatsApp</a></li>
            <li id="ref6">Мессенджеры 2016: самые интересные приложения для мгновенного обмена сообщениями // ITC.ua. [Электронный ресурс]. – Режим доступа: <a href="http://itc.ua/articles/messendzheryi-2016-samyie-interesnyie-prilozheniya-dlya-mgnovennogo-obmena-soobshheniyami/">http://itc.ua/articles/messendzheryi-2016-samyie-interesnyie-prilozheniya-dlya-mgnovennogo-obmena-soobshheniyami/</a></li>
            <li id="ref7">Вопросы и ответы по безопасности Viber // Viber. [Электронный ресурс]. – Режим доступа: <a href="https://support.viber.com/customer/ru/portal/articles/2017401-Вопросы-и-ответы-по-безопасности-viber">https://support.viber.com/customer/ru/portal/articles/2017401-Вопросы-и-ответы-по-безопасности-viber</a></li>
            <li id="ref8">Telegram (мессенджер) // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Telegram_(мессенджер)">https://ru.wikipedia.org/wiki/Telegram_(мессенджер)</a></li>
            <li id="ref9">Clients - Tox // Tox. [Электронный ресурс]. – Режим доступа: <a href="https://tox.chat/clients.html#qtox">https://tox.chat/clients.html#qtox</a></li>
            <li id="ref10">Tox // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Tox">https://ru.wikipedia.org/wiki/Tox</a></li>
            <li id="ref11">Kate Mobile Lite // Google Play. [Электронный ресурс]. – Режим доступа: <a href="https://play.google.com/store/apps/details?id=com.perm.kate_new_6">https://play.google.com/store/apps/details?id=com.perm.kate_new_6</a></li>
            <li id="ref12">Advanced Encryption Standard // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Advanced_Encryption_Standard">https://ru.wikipedia.org/wiki/Advanced_Encryption_Standard</a></li>
            <li id="ref13">RSA // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/RSA">https://ru.wikipedia.org/wiki/RSA</a></li>
            <li id="ref14">DSA // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/DSA">https://ru.wikipedia.org/wiki/DSA</a></li>
            <li id="ref15">SHA-1 // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/SHA-1">https://ru.wikipedia.org/wiki/SHA-1</a></li>
            <li id="ref16">Base64 // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Base64">https://ru.wikipedia.org/wiki/Base64</a></li>
            <li id="ref17">UTF-8 // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/UTF-8">https://ru.wikipedia.org/wiki/UTF-8</a></li>
            <li id="ref18">ASCII // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/ASCII">https://ru.wikipedia.org/wiki/ASCII</a></li>
            <li id="ref19">Порядок байтов // Википедия — свободная энциклопедия. [Электронный ресурс]. – Режим доступа: <a href="https://ru.wikipedia.org/wiki/Порядок_байтов">https://ru.wikipedia.org/wiki/Порядок_байтов</a></li>
          </ol>
        </div>
      </div>
    </main>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>
